<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUDGAME</title>
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"
  ></script>
</head>
<body>
  <div class="show stat">
    str: <span id="str">3</span>
    def: <span id="def">2</span>
    maxHP: <span id="maxHP">0</span>
    초기화 가능 횟수: <span id="resetcount">5/5</span>
    <button id="reset">능력 재설정!</button>
    <button id="confirm">이 능력치로 결정</button>
  </div>

  <script>
    // /stat으로 POST AJAX요청해서 랜덤값 받아오게하고, 결정!버튼 누르면 폼 제출되도록.
    function getData() {
        $.ajax({
            url: "/stat",
            headers: {
              Authorization: "Bearer " + key,
            },
            method: "POST"
          }).done((req) => {
            const {player} = req;
            $('#str').text(player.str);
            $('#def').text(player.def);
            $('#maxHP').text(player.maxHP);
            $('#resetcount').text(`${player.statCount}/5`);
          });
    }

    const key = localStorage.getItem("_key");
      if (!key) {
        location.href = "/";
      }
    
    getData();

    $('#reset').click(getData);
    

  </script>
</body>
</html>